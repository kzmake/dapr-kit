// Code generated by protoc-gen-gotemplate. DO NOT EDIT.
package v1

import (
	context "context"
	fmt "fmt"

	daprc "github.com/dapr/go-sdk/client"
	common "github.com/dapr/go-sdk/service/common"
	invoke "github.com/kzmake/dapr-kit/invoke"
	grpc "google.golang.org/grpc"
)

const BobServiceName = "api.bob.v1.BobService"

// aliases
type (
	invocationHandler = func(context.Context, *common.InvocationEvent) (*common.Content, error)
)

// BobServiceHandler ...
type BobServiceHandler interface {
	Handle(context.Context, *HandleRequest) (*HandleResponse, error)
}

// RegisterBobServiceInvocationHandlers ...
func RegisterBobServiceInvocationHandlers(s common.Service, impl BobServiceHandler) error {
	return invoke.RegisterInvocationHandlers(s, impl, BobServiceName)
}

type BobServiceInvocationClient interface {
	Handle(context.Context, *HandleRequest, ...grpc.CallOption) (*HandleResponse, error)
}

type BobserviceInvocationClient struct {
	appID string
	conn  *grpc.ClientConn
}

func NewBobServiceInvocationClient(appID string, conn *grpc.ClientConn) BobServiceInvocationClient {
	return &BobserviceInvocationClient{
		appID: appID,
		conn:  conn,
	}
}

func (c *BobserviceInvocationClient) Handle(ctx context.Context, in *HandleRequest, opts ...grpc.CallOption) (*HandleResponse, error) {
	cc := daprc.NewClientWithConnection(c.conn)

	reqData, err := invoke.Marshal(in)
	if err != nil {
		return nil, err
	}

	resData, err := cc.InvokeMethodWithContent(ctx, c.appID, fmt.Sprintf("%s.%s", BobServiceName, "Handle"), "POST", &daprc.DataContent{
		ContentType: invoke.ContentType,
		Data:        reqData,
	})
	if err != nil {
		return nil, err
	}

	out := &HandleResponse{}
	if err := invoke.Unmarshal(resData, out); err != nil {
		return nil, err
	}

	return out, nil
}
